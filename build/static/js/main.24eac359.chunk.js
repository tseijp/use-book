(this["webpackJsonpuse-book"]=this["webpackJsonpuse-book"]||[]).push([[0],{39:function(e){e.exports=JSON.parse('{"inputStream":{"type":"LiveStream","constraints":{"width":{"min":450},"height":{"min":300},"facingMode":"environment","aspectRatio":{"min":1,"max":2}}},"locator":{"patchSize":"medium","halfSample":true},"numOfWorkers":2,"frequency":10,"decoder":{"readers":["ean_reader"]},"locate":true}')},43:function(e,t,n){e.exports=n(52)},48:function(e,t,n){},52:function(e,t,n){"use strict";n.r(t);var c=n(17),r=n(3),o=n(1),i=n.n(o),a=n(29),u=n.n(a);n(48),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var s=n(10),l=n(8),f=n(21);function b(e){var t=e.height,n=e.limit,c=e.opened,a=e.started,u=e.onOpen,b=e.onClose,d=Object(l.useSpring)((function(){return{scale:1,x:0,y:0}})),m=Object(r.a)(d,2),h=m[0],O=h.scale,v=h.x,g=h.y,j=m[1],p=Object(o.useCallback)((function(){return j({scale:1.2,x:-25,y:-25,config:l.config.stiff})}),[j]),y=Object(o.useCallback)((function(){return j({scale:1,x:0,y:100,config:l.config.molasses})}),[j]),w=Object(o.useCallback)((function(){return j({scale:1,x:0,y:0,config:l.config.stiff})}),[j]),x=Object(f.b)({onClick:function(){return c&&a?(b(),w()):(u(),p())},onDrag:function(e){var t=e.down,c=Object(r.a)(e.movement,2),o=c[0],i=c[1],a=e.cancel;Math.pow(o,2)+Math.pow(i,2)>Math.pow(n,2)&&a&&a(),j({x:t?o:0,y:t?i:0,config:l.config.stiff})}}),k=g.to((function(e){return e<t}))?"flex":"none",E=Object(o.useMemo)((function(){return{fontSize:"2em",bottom:"1em",right:"1em",height:"2em",width:"2em",borderRadius:"4em",zIndex:99,position:"fixed",background:"coral",alignItems:"center",justifyContent:"center"}}),[]);return Object(o.useEffect)((function(){a?y():w()}),[a,y,w]),i.a.createElement(l.animated.div,Object.assign({className:"action-btn"},x(),{style:Object(s.a)(Object(s.a)({},E),{},{display:k,scale:O,x:v,y:g})}),"+")}function d(e){var t=e.children,n=e.height,c=void 0===n?100:n,a=e.started,u=void 0!==a&&a,b=e.onOpen,d=void 0===b?null:b,m=e.onClose,h=void 0===m?null:m,O=Object(l.useSpring)((function(){return{y:c}})),v=Object(r.a)(O,2),g=v[0].y,j=v[1],p=Object(o.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return d&&(d(),j({y:0,config:e?l.config.wobbly:l.config.stiff}))}),[d,j]),y=Object(o.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return h&&(h(),j({y:c,config:Object(s.a)(Object(s.a)({},l.config.stiff),{},{velocity:e})}))}),[c,h,j]),w=Object(f.a)((function(e){var t=e.last,n=Object(r.a)(e.vxvy,2)[1],o=Object(r.a)(e.movement,2),i=o[0],a=o[1],u=e.cancel;if(a<-c/3&&u&&u(),t)return(a>.5*c||n>2.5)&&-100<i&&i<100?y(n):p(n>0);j({y:a,immediate:!1,config:l.config.stiff})}),{initial:function(){return[0,g.get()]},filterTaps:!0,bounds:{top:0},rubberband:!0}),x=Object(o.useRef)((function(e){return e?p():y()}));Object(o.useEffect)((function(){x.current(u)}),[u]);var k=g.to((function(e){return e<c?"block":"none"})),E=Object(o.useMemo)((function(){return{bottom:"calc(-100vh + ".concat(c-100,"px)"),left:"2vw",width:"96vw",height:"calc(100vh + 100px)",position:"fixed",borderRadius:"4em 4em 0px",zIndex:100,backgroundColor:"rgba(0,0,0,0)",touchAction:"none"}}),[c]);return i.a.createElement(l.animated.div,Object.assign({className:"sheet"},w(),{style:Object(s.a)(Object(s.a)({},E),{},{y:g,display:k})}),t)}var m=n(39),h=n(51),O=function(e,t,n,c){return h.ImageDebug.drawPath(e,n,t,{color:c,lineWidth:2})};function v(e){var t=e.onStarted,n=e.onDetected,a=Object(o.useState)(t),u=Object(r.a)(a,1)[0],s=Object(o.useState)(n),l=Object(r.a)(s,1)[0];return Object(o.useEffect)((function(){return h.init(m,(function(e){return e?console.log(e,"error msg"):(h.start(),u(!0))})),function(){return h.stop(),u(!1)}}),[u]),Object(o.useEffect)((function(){h.onProcessed((function(e){if(e){var t=h.canvas.ctx.overlay,n=h.canvas.dom.overlay;e.boxes&&function(e,t){t.clearRect.apply(t,[0,0].concat(Object(c.a)(["width","height"].map((function(t){return Number(e.getAttribute(t))})))))}(n,t),e.boxes.forEach((function(n){return function(e,t,n){return O(e,t,{x:0,y:1},n?"#0F0":"#00F")}(n,t,n===e.box)})),e.codeResult&&O(e.line,t,{x:"x",y:"y"},"#F00")}})),h.onDetected((function(e){return l(e.codeResult.code)}))}),[l]),i.a.createElement("div",{id:"interactive",className:"viewport",style:{width:"100%",height:"100%",top:0,bottom:0}})}function g(e){var t=e.children,n=e.width,c=void 0===n?600:n,a=e.visible,u=void 0===a?4:a,b=e.style,d=void 0===b?{}:b,m=Object(o.useMemo)((function(){return t.length>u?t.length:u}),[t,u]),h=Object(o.useCallback)((function(e){return(e<0?e+m:e)%m}),[m]),O=Object(o.useCallback)((function(e,t,n){return h(e-t+n)}),[h]),v=Object(l.useSprings)(m,(function(e){return{x:(e<m-1?e:-1)*c}})),g=Object(r.a)(v,2),j=g[0],p=g[1],y=Object(o.useRef)([0,1]),w=Object(o.useRef)(0),x=Object(o.useRef)(0),k=Object(o.useCallback)((function(e,t){var n=h(Math.floor(e/c)%m),r=t<0?m-u:1;p((function(o){var i=O(o,n,r),a=O(o,y.current[0],y.current[1]),u=t>0?i:m-i-1;return{x:-e%(c*m)+c*(n-(e<0?m:0)+i-r),immediate:t<0?a>i:a<i,config:{tension:100*(1+m-u),friction:30+40*u}}})),y.current=[n,r]}),[h,O,c,u,p,m]),E=Object(f.b)({onDrag:function(e){var t=Object(r.a)(e.offset,1)[0],n=Object(r.a)(e.vxvy,1)[0];return n&&(x.current=-t,k(w.current-t,-n))},onWheel:function(e){var t=Object(r.a)(e.offset,2)[1],n=Object(r.a)(e.vxvy,2)[1];return n&&(w.current=t,k(x.current+t,n))}});return i.a.createElement("div",Object.assign({},E(),{style:{position:"absolute",bottom:0,left:0,width:"100%",height:"100%"}}),j.map((function(e,n){var c=e.x;return i.a.createElement(l.animated.div,{key:n,style:Object(s.a)({position:"absolute",x:c,willChange:"transform"},d)},t[n])})))}function j(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{current:[]},r=new URL("".concat(n.match("https")?"":"https://").concat(n)),o=r.pathname.split("/").filter((function(e){return e})),i=o.map((function(e,t){return"dp"===e&&t})).find((function(e){return e}))||0,a=o.find((function(e,t){return t===i+1}))||"",u=i>0?o[0]:"",s=(null===(e=o.find((function(e){return e.match("ref=")})))||void 0===e?void 0:e.split("ref=")[1])||"";return null===c||void 0===c||null===(t=c.current)||void 0===t||t.push(parseInt(a,10)),{name:u,isbn:a,ref:s}}function p(e){var t=e.url,n=void 0===t?"":t,c=e.limit,a=void 0===c?400:c,u=e.style,b=void 0===u?{}:u,d=e.onOpen,m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.size,c=void 0===n?"LZZZZZZZ":n,i=t.isssl,a=void 0!==i&&i,u=t.search,l=void 0===u?10:u,f=Object(o.useRef)([]),b=Object(o.useRef)(new Image),d=Object(o.useRef)(""),m=Object(o.useMemo)((function(){return"".concat(a?"images-na.ssl-images-":"images-jp.","amazon.com")}),[a]),h=Object(o.useMemo)((function(){return j(e,f)}),[e]),O=Object(o.useState)(null),v=Object(r.a)(O,2),g=v[0],p=v[1],y=Object(o.useCallback)((function(e){return"http://".concat(m,"/images/P/").concat(e,".09.").concat(c)}),[m,c]),w=Object(o.useCallback)((function(){var e=f.current[0],t=f.current.length,n=e+~~((t+1)/2)*(t%2*2-1);if(!(t>l||d.current))return f.current.push(n),p((function(e){return Object(s.a)(Object(s.a)({},e),{},{src:y(n)})}))}),[y,l]);return Object(o.useEffect)((function(){if(!d.current){var e=f.current.slice(-1)[0]||h.isbn,t=y(e),n=h.name||"";p({src:t,alt:n}),b.current.src=t,b.current.onload=function(){var e=b.current.width,t=b.current.height;if(e<2||t<2)return w();d.current=b.current.src}}}),[y,w,h,g.src]),{path:h,image:b,img:g}}(n),h=Object(o.useRef)(!1),O=Object(l.useSpring)((function(){return{scale:1,x:0,y:0}})),v=Object(r.a)(O,2),g=v[0],p=g.scale,y=g.x,w=g.y,x=v[1],k=Object(f.b)({onHover:function(e){return x({scale:e.hovering?1.1:1})},onClick:function(e){return d(),e.stopPropagation()},onDrag:function(e){var t=e.down,n=Object(r.a)(e.vxvy,1)[0],c=Object(r.a)(e.movement,2),o=c[0],i=c[1],u=e.cancel;Math.pow(o,2)+Math.pow(i,2)>Math.pow(a,2)&&u&&u();var s=100<Math.floor(o)||2<Math.floor(n)||t||h.current;if(x({x:t?o:0,y:t?i:0,scale:s&&Math.floor(i)<a/2?1.2:.8}),s)return null;h.current=!0,d()}}),E=Object(o.useMemo)((function(){return{div:Object(s.a)({width:"auto",height:"100%",scale:p,x:y,y:w,zIndex:1},b),img:{width:"auto",height:"100%",borderRadius:"1em",pointerEvents:"none"}}}),[b,p,y,w]);return i.a.createElement(l.animated.div,Object.assign({style:E.div},k()),m.img&&i.a.createElement("img",Object.assign({alt:"book",style:E.img},m.img)))}var y=[4041013380,4041002877,4041315220,4041067944,4041366054,4041245257],w=function(){var e=Object(o.useState)([]),t=Object(r.a)(e,2),n=t[0],a=t[1],u=Object(o.useState)(""),s=Object(r.a)(u,2),l=s[0],f=s[1],m=Object(o.useState)([].concat(y).map((function(e){return"amazon.com/dp/".concat(e,"/")}))),h=Object(r.a)(m,2),O=h[0],j=h[1],w=Object(o.useState)(!1),x=Object(r.a)(w,2),k=x[0],E=x[1],C=Object(o.useState)(!1),S=Object(r.a)(C,2),R=S[0],M=S[1],z=Object(o.useRef)(null),I=Object(o.useCallback)((function(e){if(null===z.current&&(10===e.length||13===e.length)){var t=10===e.length?e:e.slice(3);n.filter((function(e){return e.match(t)})).length||(z.current=t,setTimeout((function(){return z.current=null}),2e3),a((function(e){return[].concat(Object(c.a)(e),["amazon.com/dp/".concat(t)])})))}}),[n]),D=Object(o.useCallback)((function(e){E(!1),setTimeout((function(){return f(e),j((function(t){return[].concat(Object(c.a)(t),[e])}))}),1)}),[]);return console.log("Index Render ".concat(k?"":"no ","opened ").concat(R?"":"no ","started")),i.a.createElement(o.Fragment,null,i.a.createElement(b,{onOpen:function(){return!k&&E(!0)},onClose:function(){return k&&E(!1)},height:.96*window.innerHeight,limit:200,opened:k,started:R}),i.a.createElement(d,{onOpen:function(){return!k&&(E(!0),f(""),a([]))},onClose:function(){return k&&E(!1)},height:.96*window.innerHeight,started:R},k&&i.a.createElement(v,{onStarted:function(e){return M(e)},onDetected:I}),k&&R&&i.a.createElement(g,{width:window.innerWidth/4,visible:6,style:{height:"40%",bottom:"15%",left:0}},n.map((function(e,t){return i.a.createElement(p,{key:t,url:e,onOpen:function(){return D(e)}})})))),i.a.createElement(g,{width:window.innerWidth/3,visible:5,style:{height:"50%",top:0,left:0}},O.map((function(e,t){return i.a.createElement(p,{key:t,url:e,onOpen:function(){return f(e)}})}))),i.a.createElement("div",{style:{position:"fixed",width:"auto",height:"50%",bottom:0,left:0,fontSize:"2em"}},i.a.createElement("span",{style:{color:"white"}},l&&i.a.createElement(p,{url:l,onOpen:function(){return f("")}}))))};u.a.render(i.a.createElement(w,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[43,1,2]]]);
//# sourceMappingURL=main.24eac359.chunk.js.map